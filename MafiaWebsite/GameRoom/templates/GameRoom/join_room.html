{% extends 'base/base.html' %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'GameRoom/css/Join_room.css' %}" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
  integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ=="
  crossorigin="anonymous"
/>
{% endblock %}

{% block body %}
<div class="lights-container">
  <div class="redlight"></div>
  <div class="bluelight"></div>
  <div class="redlight-small"></div>
  <div class="bluelight-small"></div>

  <div class='window'>
    <div class="title" id="title">Join a Room</div>
    <form method="post" class='Room_code'>
      {% csrf_token %}
      <label for="room_code" id="room-code-label">Room Code:</label>
      <div class="input-container">
        <input class="inputbox input-field" maxlength="1" type="text">
        <input class="inputbox input-field" maxlength="1" type="text">
        <input class="inputbox input-field" maxlength="1" type="text">
        <input class="inputbox input-field" maxlength="1" type="text">
        <input class="inputbox input-field" maxlength="1" type="text">
        <input class="inputbox input-field" maxlength="1" type="text">
      </div>
      <input id="code_hidden" maxlength="6" name="real_code" type="text">
      <button type="submit" id="submit_button" style="display: none;">Submit</button>
    </form>
    <hr>
    <div id="room-list-container">
      <h2>Available Rooms:</h2>

      <table class="table1">
        <tr class='first'>
          <th>Room code</th>
          <th>Players</th>
          <th>Private</th>
          <th>Join room</th>
        </tr>
        {% for room in rooms %}
        <tr class='data'>
          <th>{{ room.code }}</th>
          <th>{{ room.player_count }}/{{ room.max_players }}</th>
          {% if room.is_private %}
            <th><i class="fas fa-lock"></i></th>
          {% else %}
            <th><i class="fas fa-unlock" style="color: #ffffff;"></i></th>
          {% endif %}
          <th>
            <form id="join-room-form-{{ room.code }}" method="post">
              {% csrf_token %}
              <input type="hidden" name="room_code" value="{{ room.code }}">
              {% if room.is_private %}
                <input class='password' type="password" name="password" placeholder="Enter the password">
              {% endif %}
              <button class="join-room-link" type="submit">Join</button>
            </form>
          </th>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div id="room-code" data-room-code="{{ room.code }}" style="display: none;"></div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="{% static 'GameRoom/js/title.js' %}"></script>
  <script src="{% static 'GameRoom/js/join_room.js' %}"></script>
  <script src="{% static 'GameRoom/js/room_list.js' %}"></script>

  <script>
    const joinRoomURL = "{% url 'GameRoom:join_room' %}";
  </script>
{% endblock %}
